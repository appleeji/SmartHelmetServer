<!DOCTYPE html>
<html>
<head>
<title>UOC_HELMET</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="../layout/styles/layout.css" rel="stylesheet" type="text/css" media="all">
</head>
<body id="top">
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->

    <!-- ################################################################################################ -->
  </div>
</div>
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- Top Background Image Wrapper -->
 <div class="bgded overlay" style="background-image:url('../images/demo/backgrounds/bottom.png');">   
  <!-- ################################################################################################ -->
  <div class="wrapper row1">
    <header id="header" class="hoc clear"> 
      <!-- ################################################################################################ -->
      <div id="logo" class="fl_left">
        <h1><a href="../index.html">UOC_HELMET</a></h1>
      </div>
      <nav id="mainav" class="fl_right">
        <ul class="clear">
          <li><a href="../index.html">Home</a></li>
          <li class="active"><a class="drop" href="#">User1</a>
            <ul>
              <li class="active"><a href="user1_location.html">Location</a></li>
              <li><a href="user1_data.html">Data</a></li>
            </ul>
          </li>
                    <li class="active"><a class="drop" href="#">User2</a>
            <ul>
              <li class="active"><a href="gallery.html">Location</a></li>
              <li><a href="full-width.html">Data</a></li>
            </ul>
          </li>
                    <li class="active"><a class="drop" href="#">User3</a>
            <ul>
              <li class="active"><a href="gallery.html">Location</a></li>
              <li><a href="full-width.html">Data</a></li>
            </ul>
          </li>

        </ul>
      </nav>
      <!-- ################################################################################################ -->
    </header>
  </div>
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <div class="wrapper row2">
    <div id="breadcrumb" class="hoc clear"> 
      <!-- ################################################################################################ -->
      <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">User1</a></li>
        <li><a href="#">Location</a></li>
      </ul>
      <!-- ################################################################################################ -->
    </div>
  </div>
  <!-- ################################################################################################ -->
</div>
<!-- End Top Background Image Wrapper -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<div class="wrapper row3">
  <main class="hoc container clear"> 
    <!-- main body -->
    <!-- ################################################################################################ -->
    <div class="content"> 
      <!-- ################################################################################################ -->
      <div id="gallery">
        <figure>
          <header class="heading">User1 Location</header>
          <ul class="nospace clear">
</html>
<DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd\">
<html lang="en">
<head>
<meta charset="UTF-8">
<script src="Chart.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="jquery/iphone-style-checkboxes.js"></script>
<script src="jquery/iphone-style-checkboxes.js"></script>
  <script
    src="https://code.jquery.com/jquery-2.2.4.min.js"
    integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
    crossorigin="anonymous"></script>
<link rel="stylesheet" href="style.css">

<style>
    canvas{
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }
</style>
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">    
</head>
<body>
<div id="map" style="width:100%;height:500px;"></div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=3e597cdc14d62e1e0d6daaf8cc15aa01"></script>
<script>

    var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
        mapOption = {
            center: new daum.maps.LatLng(36.764986, 127.281165), // 지도의 중심좌표
            level: 3 // 지도의 확대 레벨 
        };

    var map = new daum.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
    // 마커를 표시할 위치와 title 객체 배열입니다    

    var positions = [
    {
        title: '사용자1',
        latlng: new daum.maps.LatLng(36.763573, 127.281100)
    },
    {
        title: '사용자2',
        latlng: new daum.maps.LatLng(36.764972, 127.279000)
    },
    {
        title: '사용자3',
        latlng: new daum.maps.LatLng(36.766513, 127.283815)
    }
];

    // 마커 이미지의 이미지 주소입니다
    var imageSrc = "http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";

    for (var i = 0; i < positions.length; i++) {

        // 마커 이미지의 이미지 크기 입니다
        var imageSize = new daum.maps.Size(24, 35);

        // 마커 이미지를 생성합니다    
        var markerImage = new daum.maps.MarkerImage(imageSrc, imageSize);

        // 마커를 생성합니다
        var marker = new daum.maps.Marker({
            map: map, // 마커를 표시할 지도
            position: positions[i].latlng, // 마커를 표시할 위치
            title: positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
            image: markerImage // 마커 이미지 
        });
    }
    var sw = new daum.maps.LatLng(36.764061, 127.280507), // 사각형 영역의 남서쪽 좌표
    ne = new daum.maps.LatLng(36.763339, 127.281279); // 사각형 영역의 북동쪽 좌표

    // 사각형을 구성하는 영역정보를 생성합니다
    // 사각형을 생성할 때 영역정보는 LatLngBounds 객체로 넘겨줘야 합니다
    var rectangleBounds = new daum.maps.LatLngBounds(sw, ne);

    // 지도에 표시할 사각형을 생성합니다
    var rectangle = new daum.maps.Rectangle({
        bounds: rectangleBounds, // 그려질 사각형의 영역정보입니다
        strokeWeight: 4, // 선의 두께입니다
        strokeColor: '#990000', // 선의 색깔입니다
        strokeOpacity: 1, // 선의 불투명도 입니다 1에서 0 사이의 값이며 0에 가까울수록 투명합니다
        strokeStyle: 'shortdashdot', // 선의 스타일입니다
        fillColor: '#CC0000', // 채우기 색깔입니다
        fillOpacity: 0.8 // 채우기 불투명도 입니다
    });

    // 지도에 사각형을 표시합니다
    rectangle.setMap(map);

    var sw = new daum.maps.LatLng(36.766851, 127.280972), // 사각형 영역의 남서쪽 좌표
    ne = new daum.maps.LatLng(36.766146, 127.280532); // 사각형 영역의 북동쪽 좌표

    // 사각형을 구성하는 영역정보를 생성합니다
    // 사각형을 생성할 때 영역정보는 LatLngBounds 객체로 넘겨줘야 합니다
    var rectangleBounds = new daum.maps.LatLngBounds(sw, ne);

    // 지도에 표시할 사각형을 생성합니다
    var rectangle = new daum.maps.Rectangle({
        bounds: rectangleBounds, // 그려질 사각형의 영역정보입니다
        strokeWeight: 4, // 선의 두께입니다
        strokeColor: '#FF3DE5', // 선의 색깔입니다
        strokeOpacity: 1, // 선의 불투명도 입니다 1에서 0 사이의 값이며 0에 가까울수록 투명합니다
        strokeStyle: 'shortdashdot', // 선의 스타일입니다
        fillColor: '#FF8AEF', // 채우기 색깔입니다
        fillOpacity: 0.8 // 채우기 불투명도 입니다
    });

    // 지도에 사각형을 표시합니다
    rectangle.setMap(map);


    map.addOverlayMapTypeId(daum.maps.MapTypeId.TRAFFIC);  

    var socket = io.connect('http://1.214.233.64:5000');
    socket.on('connect', function () {
        socket.on('mqtt', function (msg) {
            console.log(msg.topic + ' ' + msg.payload);

            //  var lat2 = Number(vector_id),
            //  lon2 = Number(x_rotation_id); // 경도

            // HTML5의 geolocation으로 사용할 수 있는지 확인합니다
            /*
            if (navigator.geolocation) {
    
            // GeoLocation을 이용해서 접속 위치를 얻어옵니다
            navigator.geolocation.getCurrentPosition(function(position) {
        
            //var lat = position.coords.latitude, // 위도
            //    lon = position.coords.longitude; // 경도
            //var lat = parseFloat(vector_id),
            //    lon = parseFloat(x_rotation_id); // 경도
            var lat2 = parseDouble(vector_id),
            lon2 = parseDouble(x_rotation_id); // 경도

         
        
            window.onload = function() {
            var ctx = document.getElementById("canvas").getContext("2d");
            window.myLine = new Chart(ctx, config);
            //console.log($('#vector_id').text());
            //console.log(vector);
            //$('#vector_id').append(vector);
            };

            var locPosition = new daum.maps.LatLng(lat2, lon), // 마커가 표시될 위치를 geolocation으로 얻어온 좌표로 생성합니다
            message = '<div style="padding:5px;">여기에 계신가요?!</div>'; // 인포윈도우에 표시될 내용입니다
            
            // 마커와 인포윈도우를 표시합니다
            displayMarker(locPosition, message);

        
            });
    
            } 
            */
            // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다
            var strArray = msg.payload.split('*');
            var x1 = strArray[0];
            var y1 = strArray[1];

            x1 = parseFloat(x1);
            y1 = parseFloat(y1);

            // alert(typeof x1);
            //  alert(typeof y1);

            var x2 = 36.763673;
            var y2 = 127.281923;

            var locPosition = new daum.maps.LatLng(x1, y1),
        message = '여기에 계신가요?';

            displayMarker(locPosition, message);


            // 지도에 마커와 인포윈도우를 표시하는 함수입니다
            function displayMarker(locPosition, message) {

                // 마커를 생성합니다
                var marker = new daum.maps.Marker({
                    map: map,
                    position: locPosition
                });


                var iwContent = message, // 인포윈도우에 표시할 내용
        iwRemoveable = true;

                // 인포윈도우를 생성합니다
                var infowindow = new daum.maps.InfoWindow({
                    content: iwContent,
                    removable: iwRemoveable
                });

                // 인포윈도우를 마커위에 표시합니다 
                infowindow.open(map, marker);

                // 지도 중심좌표를 접속위치로 변경합니다
                map.setCenter(locPosition);
            }

        });
        socket.emit('subscribe', { topic: 'gps' });
    });
    window.onload = function () {
        var ctx = document.getElementById("canvas").getContext("2d");
        window.myLine = new Chart(ctx, config);
        //console.log($('#vector_id').text());
        //console.log(vector);
        //$('#vector_id').append(vector);

    };



</script>

<table>
        <thead>
        <tr>
            <th width="200px">vector</th>
            <th width="200px">x_rotation</th>
            <th width="200px">y_rotation</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td width="200px"><a style="text-align:center" id="vector_id"></a></td>
            <td width="200px"><a style="text-align:center"id="x_rotation_id"></a></td>
            <td width="200px"><a style="text-align:center"id="y_rotation_id"></a></td>
        </tr>
    </tbody>
    </table>
</body>
</html>
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- Footer Background Image Wrapper -->
<DOCTYPE html>
<html>
<body>
<div class="bgded overlay" style="background-image:url('../images/demo/backgrounds/bottom.png');"> 
  <!-- ################################################################################################ -->
  <div class="wrapper row4">
    <footer id="footer" class="hoc clear"> 
      <!-- ################################################################################################ -->
      <div class="btmspace-50 center">
        <h2 class="heading">UOC_HELMET</h2>
        <p>이 사이트는 한국기술교육대학교 UOC LAB 2017 졸업작품 위한 사이트입니다.</p>
      </div>
      <ul class="nospace group">
        <li class="one_quarter first">
          <div class="infobox"><i class="fa fa-phone"></i>
            <ul class="nospace">
              <li>(041) 560 1114</li>
            </ul>
          </div>
        </li>
        <li class="one_quarter">
          <div class="infobox"><i class="fa fa-envelope-o"></i>
            <ul class="nospace">
              <li>uocnas2.kut.ac.kr:5000</li>
            </ul>
          </div>
        </li>
        <li class="one_quarter">
          <div class="infobox"><i class="fa fa-clock-o"></i>
            <ul class="nospace">
              <li>~ 2017/09/27</li>
            </ul>
          </div>
        </li>
        <li class="one_quarter">
          <div class="infobox"><i class="fa fa-support"></i>
            <ul class="nospace">
              <li>김민섭 신인호 손지원 <p></p>정병훈 조아현</li>
            </ul>
          </div>
        </li>
      </ul>
      <!-- ################################################################################################ -->
    </footer>
  </div>
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <div class="wrapper row5">
    <div id="copyright" class="hoc clear"> 
      <!-- ################################################################################################ -->
      <p class="fl_left">Copyright &copy; 2017 <a href="#">UOC_HELMET</a></p>
      <!-- ################################################################################################ -->
    </div>
  </div>
  <!-- ################################################################################################ -->
</div>
<!-- End Footer Background Image Wrapper -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<a id="backtotop" href="#top"><i class="fa fa-chevron-up"></i></a>
<!-- JAVASCRIPTS -->
<script src="../layout/scripts/jquery.min.js"></script>
<script src="../layout/scripts/jquery.backtotop.js"></script>
<script src="../layout/scripts/jquery.mobilemenu.js"></script>
</body>
</html>